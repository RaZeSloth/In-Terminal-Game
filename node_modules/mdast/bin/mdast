#!/usr/bin/env node
'use strict';

/*
 * Dependencies.
 */

var cli = require('../lib/cli');

/*
 * Methods.
 */

var stderr = process.stderr;
var argv = process.argv;

/*
 * Constants.
 */

var exitStatus = 0;

/**
 * Run.
 *
 * @param {Error?} exception
 */
function done(exception) {
    if (exception) {
        stderr.write((exception.stack || exception) + '\n');
    }

    exitStatus = 1;
}

/*
 * Set-up.
 */

var position = argv.indexOf('--');

if (position !== -1) {
    argv = argv.slice(0, position);
}

/*
 * Process.
 */

try {
    cli(argv, done);
} catch (err) {
    done(err);
}

/*
 * Exit.
 */

process.on('exit', function () {
    /* eslint-disable no-process-exit */
    process.exit(exitStatus);
    /* eslint-enable no-process-exit */
});
